<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Vote</title>
    <script src="https://cdn.rawgit.com/ethereum/web3.js/0.19.0/dist/web3.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">

    <script type="text/javascript">
        var voterAddress;
        var myContract;

        var abi = [{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"","type":"string"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_spender","type":"address"},{"name":"_amount","type":"uint256"}],"name":"approve","outputs":[{"name":"success","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"nextTokenDistribution","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"totalSupply","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"totalVotesRecevied","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_amount","type":"uint256"}],"name":"transferFrom","outputs":[{"name":"success","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"timestamp","type":"uint256"}],"name":"getHour","outputs":[{"name":"","type":"uint8"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_amount","type":"uint256"}],"name":"burn","outputs":[],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_address","type":"address"},{"name":"_amount","type":"uint256"}],"name":"vote","outputs":[],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_amount","type":"uint256"}],"name":"distributeTokens","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"canDistributeTokens","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"nextVoteDistribution","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"projects","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"voteBalanceOf","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"","type":"string"}],"payable":false,"type":"function"},{"constant":true,"inputs":[],"name":"canDistributeVotes","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_value","type":"uint256"}],"name":"transfer","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"getHoldersVoteAllocation","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"holderKeys","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_project","type":"address"}],"name":"getProjectTokens","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"projectKeys","outputs":[{"name":"","type":"address"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"projectVotes","outputs":[{"name":"","type":"uint256"}],"payable":false,"type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_spender","type":"address"}],"name":"allowance","outputs":[{"name":"remaining","type":"uint256"}],"payable":false,"type":"function"},{"constant":false,"inputs":[{"name":"_amount","type":"uint256"}],"name":"distributeVotes","outputs":[{"name":"","type":"bool"}],"payable":false,"type":"function"},{"inputs":[{"name":"totalSupply","type":"uint256"},{"name":"_nextTokenDistribution","type":"uint256"},{"name":"_nextVoteDistribution","type":"uint256"}],"payable":false,"type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_from","type":"address"},{"indexed":true,"name":"_to","type":"address"},{"indexed":false,"name":"_value","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_owner","type":"address"},{"indexed":true,"name":"_spender","type":"address"},{"indexed":false,"name":"_value","type":"uint256"}],"name":"Approval","type":"event"}];

        var code = '606060405260408051908101604052600381527f52504d0000000000000000000000000000000000000000000000000000000000602082015260009080516200004d9291602001906200011f565b5060408051908101604052600381527f52504d000000000000000000000000000000000000000000000000000000000060208201526001908051620000979291602001906200011f565b5060066002553415620000a957600080fd5b604051606080620012a38339810160405280805191906020018051919060200180519150505b60088054600160a060020a03191633600160a060020a03169081179091556003849055600254600091825260046020526040909120600a91820a8502905560098390558190555b505050620001c9565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f106200016257805160ff191683800117855562000192565b8280016001018555821562000192579182015b828111156200019257825182559160200191906001019062000175565b5b50620001a1929150620001a5565b5090565b620001c691905b80821115620001a15760008155600101620001ac565b5090565b90565b6110ca80620001d96000396000f300606060405236156101515763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166306fdde038114610156578063095ea7b3146101e15780631791193f1461021757806318160ddd1461023c5780631f544d1a1461026157806323b872dd14610286578063313ce567146102c25780633e239e1a146102e757806342966c68146103135780635f74bbde1461032b57806370a082311461034f5780637366794e1461038057806376412dc6146103aa5780637d8abeed146103d1578063840e78fd146103f657806384ab8bb81461042757806395d89b4114610458578063a849e7eb146104e3578063a9059cbb1461050a578063c29fc80114610540578063d48ff3f614610571578063d8599e84146105a3578063d8821bf0146105d4578063d9dd057c14610606578063dd62ed3e14610637578063fc2664561461066e575b600080fd5b341561016157600080fd5b610169610698565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101a65780820151818401525b60200161018d565b50505050905090810190601f1680156101d35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101ec57600080fd5b610203600160a060020a0360043516602435610736565b604051901515815260200160405180910390f35b341561022257600080fd5b61022a610771565b60405190815260200160405180910390f35b341561024757600080fd5b61022a610777565b60405190815260200160405180910390f35b341561026c57600080fd5b61022a61077e565b60405190815260200160405180910390f35b341561029157600080fd5b610203600160a060020a0360043581169060243516604435610784565b604051901515815260200160405180910390f35b34156102cd57600080fd5b61022a610902565b60405190815260200160405180910390f35b34156102f257600080fd5b6102fd600435610908565b60405160ff909116815260200160405180910390f35b341561031e57600080fd5b61032960043561092e565b005b341561033657600080fd5b610329600160a060020a0360043516602435610990565b005b341561035a57600080fd5b61022a600160a060020a03600435166109f7565b60405190815260200160405180910390f35b341561038b57600080fd5b610203600435610a16565b604051901515815260200160405180910390f35b34156103b557600080fd5b610203610ae7565b604051901515815260200160405180910390f35b34156103dc57600080fd5b61022a610aff565b60405190815260200160405180910390f35b341561040157600080fd5b61022a600160a060020a0360043516610b05565b60405190815260200160405180910390f35b341561043257600080fd5b61022a600160a060020a0360043516610b17565b60405190815260200160405180910390f35b341561046357600080fd5b610169610b36565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101a65780820151818401525b60200161018d565b50505050905090810190601f1680156101d35780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156104ee57600080fd5b610203610bd4565b604051901515815260200160405180910390f35b341561051557600080fd5b610203600160a060020a0360043516602435610bec565b604051901515815260200160405180910390f35b341561054b57600080fd5b61022a600160a060020a0360043516610d9c565b60405190815260200160405180910390f35b341561057c57600080fd5b610587600435610dd8565b604051600160a060020a03909116815260200160405180910390f35b34156105ae57600080fd5b61022a600160a060020a0360043516610e0a565b60405190815260200160405180910390f35b34156105df57600080fd5b610587600435610e68565b604051600160a060020a03909116815260200160405180910390f35b341561061157600080fd5b61022a600160a060020a0360043516610e9a565b60405190815260200160405180910390f35b341561064257600080fd5b61022a600160a060020a0360043581169060243516610eb9565b60405190815260200160405180910390f35b341561067957600080fd5b610203600435610ee6565b604051901515815260200160405180910390f35b60008054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561072e5780601f106107035761010080835404028352916020019161072e565b820191906000526020600020905b81548152906001019060200180831161071157829003601f168201915b505050505081565b600254600160a060020a033381166000908152600660209081526040808320938716835292905220600a9190910a8202905560015b92915050565b60095481565b6003545b90565b600b5481565b600160a060020a0383166000908152600460205260408120548290108015906107d45750600160a060020a0380851660009081526006602090815260408083203390941683529290522054829010155b80156107e05750600082115b80156108055750600160a060020a038316600090815260046020526040902054828101115b156108f657600254600160a060020a03851660009081526004602052604090205461083a91600a0a840263ffffffff610fd716565b600160a060020a0380861660009081526004602090815260408083209490945560025460068252848320339094168352929052919091205461088691600a0a840263ffffffff610fd716565b600160a060020a038086166000908152600660209081526040808320338516845282528083209490945560025492871682526004905291909120546108d591600a0a840263ffffffff610fee16565b600160a060020a0384166000908152600460205260409020555060016108fa565b5060005b5b9392505050565b60025481565b60006018603c80845b0481151561091b57fe5b0481151561092557fe5b0690505b919050565b60085433600160a060020a0390811691161461094957600080fd5b600854819061096090600160a060020a03166109f7565b101561096b57600080fd5b600854600160a060020a03166000908152600460205260409020805482900390555b50565b600160a060020a033316600090815260056020526040902054819010156109b657600080fd5b600160a060020a033381166000908152600560209081526040808320805486900390559285168252600c905220805482019055600b805460010190555b5050565b600160a060020a0381166000908152600460205260409020545b919050565b6008546000908190819033600160a060020a03908116911614610a3857600080fd5b60008411610a4557600080fd5b610a4d610ae7565b1515610a5857600080fd5b6009805462093a80019055600091505b600d54821015610ad657600d805483908110610a8057fe5b906000526020600020900160005b9054906101000a9004600160a060020a03169050610aab81610e0a565b600160a060020a0382166000908152600460205260409020805490910190555b600190910190610a68565b6000600b55600192505b5050919050565b6009546000904211610af857600080fd5b5060015b90565b600a5481565b600c6020526000908152604090205481565b600160a060020a0381166000908152600560205260409020545b919050565b60018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561072e5780601f106107035761010080835404028352916020019161072e565b820191906000526020600020905b81548152906001019060200180831161071157829003601f168201915b505050505081565b600a546000904211610af857600080fd5b5060015b90565b6000808080600160a060020a0386161515610c0657600080fd5b600254600160a060020a033316600090815260046020526040902054610c3691600a0a870263ffffffff610fd716565b600160a060020a033381166000908152600460205260408082209390935560025491891681529190912054610c7591600a0a870263ffffffff610fee16565b600160a060020a03871660009081526004602052604081209190915592508291505b600754821015610d00576007805483908110610caf57fe5b906000526020600020900160005b9054906101000a9004600160a060020a0316905085600160a060020a031681600160a060020a03161415610cf45760019250610d00565b5b600190910190610c97565b821515610d47576007805460018101610d198382611053565b916000526020600020900160005b8154600160a060020a03808b166101009390930a92830292021916179055505b85600160a060020a031633600160a060020a03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef8760405190815260200160405180910390a3600193505b50505092915050565b600160a060020a0381166000908152600460205260408120546003548290610dcb90839063ffffffff61100816565b90508092505b5050919050565b6007805482908110610de657fe5b906000526020600020900160005b915054906101000a9004600160a060020a031681565b600160a060020a0381166000908152600460205260408120548190819011610e3157600080fd5b600b54600160a060020a038416600090815260056020526040902054610e5c9163ffffffff61100816565b90508091505b50919050565b600d805482908110610de657fe5b906000526020600020900160005b915054906101000a9004600160a060020a031681565b600160a060020a0381166000908152600c60205260409020545b919050565b600160a060020a038083166000908152600660209081526040808320938516835292905220545b92915050565b6008546000908190819033600160a060020a03908116911614610f0857600080fd5b60008411610f1557600080fd5b610f1d610bd4565b1515610f2857600080fd5b600a805462093a80019055600091505b600754821015610fcb576007805483908110610f5057fe5b906000526020600020900160005b9054906101000a9004600160a060020a03169050610fa0600254600a0a610f9486610f8885610d9c565b9063ffffffff61102416565b9063ffffffff61100816565b600160a060020a0382166000908152600560205260409020805490910190555b600190910190610f38565b600192505b5050919050565b600082821115610fe357fe5b508082035b92915050565b600082820183811015610ffd57fe5b8091505b5092915050565b600080828481151561101657fe5b0490508091505b5092915050565b6000828202831580611040575082848281151561103d57fe5b04145b1515610ffd57fe5b8091505b5092915050565b8154818355818115116110775760008381526020902061107791810190830161107d565b5b505050565b61077b91905b808211156110975760008155600101611083565b5090565b905600a165627a7a72305820e6cca84f35ae3a1cb1cf52c74c003ef21f9150a07517ca7b1563fdce382cab780029';

        var contractAddress = '0x89f3e42Db3ef5979c206c62D3F73DbD51d2b8Dc9';

        window.addEventListener('load', function() {

            // Load WEB3
            // Check wether it's already injected by something else (like Metamask or Parity Chrome plugin)
            if(typeof web3 !== 'undefined') {
                web3 = new Web3(web3.currentProvider);  

            // Or connect to a node
            } else {
                web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
            }

            // Check the connection
            if(!web3.isConnected()) {
                console.error("Not connected");

            }

            // let's assume that coinbase is our account
            web3.eth.defaultAccount = web3.eth.coinbase;
            var contractAddress = '0x89f3e42Db3ef5979c206c62D3F73DbD51d2b8Dc9';
            // create contract
            web3.eth.contract(abi, contractAddress, {
                from: voterAddress, // default from address
                gasPrice: '100000000000', // default gas price in wei, 20 gwei in this case
                gas: '4712388'
            }).new({data: code,
            from: voterAddress, // default from address
                gasPrice: '100000000000', // default gas price in wei, 20 gwei in this case
                gas: '4712388'}, function (err, contract) {
                if(err) {
                    console.error(err);
                    return;
                // callback fires twice, we only want the second call when the contract is deployed
                } else if(contract.address){
                    myContract = contract;
                    console.log('address: ' + myContract.address);
                }
            });

        });
        
        function vote() {
            var projectAddress = $('#projectAddress').val();
            var votes = parseInt($('#amount').val());
            var res = myContract.vote(projectAddress, votes);

            alert(res);
        }
     </script>
</head>
<body>
    <form>
        <h1>Vote</h1>
        <span>Voter address</span>
        <input type="text" id="voterAddress" value=""></input>

        <span>Vote address</span>
        <input type="text" id="projectAddress" value="0xe2356d29d5dfecb4ee43c031204aeded24749959"></input>
        <br/>

        <span>Amount</span>
        <input id="amount" value="1"></input>
        <br/>

        <button type="button" onClick="vote();">vote</button>
    </form>
    
    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>

    
</body>
</html>